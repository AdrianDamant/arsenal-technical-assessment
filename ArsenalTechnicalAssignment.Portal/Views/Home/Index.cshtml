@model PlayersTableModel
@{
    ViewData["Title"] = "Home Page";
}

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- DataTables CSS -->
<link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet">


<div class="text-center">
    <h1 class="display-4">Players Management</h1>


    <main id="main" class="d-flex flex-column" style="height:90vh">
        <section class="card" data-aos="fade-up">
            <div class="m-2" style="height: 80vh;">
                <div class="card shadow-sm h-100" data-aos="fade-up">
                    <div class="card-header d-flex justify-content-end align-items-center bg-danger text-white">
                        <div>
                            <button class="btn btn-warning ms-5" onclick="location.href='@Url.Action("FilterbyGoalsScored", "Home")'">Filter by Goals Scored</button>
                        </div>
                        <div>
                            <button class="btn btn-warning ms-5" title="" data-bs-toggle="modal" data-bs-target="#Create-Player-Modal">Create Player</button>
                        </div>
                    </div>
                    <div class="card-body pe-3 ps-3 pb-3 pt-0 custom-scrollbar" style="height: 250px; overflow-y: auto;">
                        <table class="table table-hover">
                            <thead class="table-light sticky-top " style="z-index:999">
                                <tr>
                                    @{
                                        <th></th>
                                        <th>Player Name</th>
                                        <th>Position</th>
                                        <th>Jersey Number</th>
                                        <th>Goals Scored</th>
                                        <th>Date Created</th>
                                        <th>Date Modified</th>
                                        <th></th>
                                        <th></th>
                                    }
                                </tr>
                            </thead>
                            <tbody id="machineTable">
                                @if(Model is not null && Model.Players is not null)
                                {
                                    @foreach (var item in Model.Players)
                                    {
                                        <tr style="cursor: pointer;">
                                            <td><i class="bi bi-circle-fill" style="color:green; font-size:25px"></i></td>
                                            <td>@item.PlayerName</td>
                                            <td>@item.Position</td>
                                            <td>@item.JerseyNumber</td>
                                            <td>@item.GoalsScored</td>
                                            <td>@item.DateCreated.ToString("dd-MM-yyyy")</td>
                                            <td>@item.DateModified.ToString("dd-MM-yyyy")</td>
                                            <td class="text-center delete-cell">
                                                <button class="editPlayer btn bi bi-pencil-fill edit-icon" data-id="@item.PlayerId"></button>
                                            </td>
                                            <td class="text-center delete-cell">
                                                <button class="deletePlayer btn bi bi-trash-fill delete-icon" data-id="@item.PlayerId"></button>
                                            </td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        <br />
    </main>
    <style>
        .delete-icon:hover {
            box-shadow: 0 0 1.5em 0 rgba(0, 0, 0, 0.1);
            color: #b02a37;
        }

        .edit-icon:hover {
            box-shadow: 0 0 1.5em 0 rgba(0, 0, 0, 0.1);
            color: orange;
        }
    </style>

    <!-- Modal Placeholder -->
    <div id="modalPlaceholder"></div>

    @section Scripts {
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

        <script>
            $(document).ready(function () {
                $(".editPlayer").click(function () {
                    var id = $(this).data("id");

                    $.ajax({
                        url: '/Home/EditPlayer',
                        type: 'GET',
                        data: { id: id },
                        success: function (response) {
                            $("#modalPlaceholder").html(response);
                            $("#Create-Player-Modal").modal("show");
                        }
                    });
                });
            });
        </script>

        <script>
            $(document).ready(function () {
                $(".deletePlayer").click(function () {
                    var id = $(this).data("id");

                    $.ajax({
                        url: '/Home/DeletePlayerConfirmation',
                        type: 'GET',
                        data: { id: id },
                        success: function (response) {
                            $("#modalPlaceholder").html(response);
                            $("#Delete-Player-Modal").modal("show");
                        }
                    });
                });
            });
        </script>

    }

    <partial name="_CreatePlayerModal" model='new CreatePlayerModel(){PlayerName=""}' />
    <partial name="_DeletePlayerModal" model='new CreatePlayerModel() { PlayerName = "" }' />
</div>
